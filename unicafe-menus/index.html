<html ng-app="unijs">

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="css/unijs.css">
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script src="js/lib/leaflet.js"></script>
  <script src="js/lib/lodash.js"></script>
  <script src="js/lib/angular.min.js"></script>
  <script src="js/lib/angular-local-storage.js"></script>
  <script src="js/lib/geolocation.js"></script>
  <script src="js/app.js"></script>
  <meta charset="utf-8">
</head>

<body ng-controller="WorldCtrl">

  <div class="main-wrapper container" >

    <ul class="nav nav-pills">
      <li role="presentation" ng-class="{active: closest}"><a href="#" ng-click="showClosest()">Closest</a></li>
      <li role="presentation" ng-class="{active: !closest}"><a href="#" ng-click="fetchFavorites()">Favorites</a></li>
      <li class="pull-right"><input type="text" ng-model="unicafe.name" placeholder="Search by name"/></li>
    </ul>

    <div ng-show="closest">
      <div class="nearest row">
      <div class="nearest-col col-md-12 bg-success">
        <h1>Your nearest unicafe: {{nearest.name}}</h1>
        <p>Distance: {{nearest.distFromUser}} meters</p>
        <h2>Menu</h2>
        <ul>
          <li ng-repeat="f in foodz"><p class="food-name">{{f.name}}</p><!--<p class="metas">(<span ng-repeat="m in f.meta.0">{{m}}<span ng-if="!$last">, </span></span>)</p>--></li>
        </ul>
      </div>
    </div>

    <div ng-repeat="unicafe in unicafeLocations | filter:unicafe.name | orderBy:'distFromUser'" class="unicafe-instance row" ng-show="unicafe !== nearest">
      <div class="col-md-12 unicafe-wrapper bg-info">
        <p class="col-md-12 lead uc-head" ng-click="fetchListById(unicafe.id)">
          {{unicafe.name}}
        </p>
        <p class="col-md-12 distance">
          {{unicafe.distFromUser}} meters
        </p>
        <div ng-if="unicafe.foodz">
          <h2>Menu</h2>
          <ul>
            <li ng-repeat="food in unicafe.foodz">{{food.name}}</li>
          </ul>
        </div>
        <button class="btn btn-default btn-sm" ng-if="favorites.indexOf(unicafe.id) === -1" ng-click="addToFavorites(unicafe.id)"><span >&lt;3</span></button>
        <button class="btn btn-default btn-sm" ng-if="favorites.indexOf(unicafe.id) !== -1" ng-click="removeFromFavorites(unicafe.id)"><span >&lt;/3</span></button>
      </div>
    </div>
  </div>

  <div class="fav-wrapper container" ng-show="!closest">
    <div ng-repeat="unicafe in favoriteUnicafes | orderBy:'distFromUser' " class="unicafe-instance row">
      <div class="col-md-12 unicafe-wrapper bg-info">
        <p class="col-md-12 lead uc-head" ng-click="fetchListById(unicafe.id)">
          {{unicafe.name}}
        </p>
        <p class="col-md-12 distance">
          {{unicafe.distFromUser}} meters
        </p>
        <div ng-if="unicafe.foodz">
          <h2>Menu</h2>
          <ul>
            <li ng-repeat="food in unicafe.foodz">{{food.name}}</li>
          </ul>
        </div>
        <button class="btn btn-default btn-sm" ng-if="favorites.indexOf(unicafe.id) === -1" ng-click="addToFavorites(unicafe.id)"><span >&lt;3</span></button>
        <button class="btn btn-default btn-sm" ng-if="favorites.indexOf(unicafe.id) !== -1" ng-click="removeFromFavorites(unicafe.id)"><span >&lt;/3</span></button>
      </div>
    </div>
  </div>
</div>

</body>
</html>